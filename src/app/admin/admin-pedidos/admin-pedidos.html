<div class="container mt-5" *ngIf="pedidos.length > 0; else noPedidos">
  <div *ngFor="let pedido of pedidos" class="card mb-4 shadow-sm border-primary">
    <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
      <span>Pedido #{{ pedido.idPedido }}</span>
      <small>{{ pedido.FechaPedido | date:'short' }}</small>
    </div>

    <div class="card-body">
      <p><strong>Cliente:</strong> {{ pedido.cliente }}</p>

      <div class="mb-3">
        <label class="form-label"><strong>Estado:</strong></label>
        <select [(ngModel)]="pedido.idEstado"
                (change)="cambiarEstado(pedido, pedido.idEstado)"
                class="form-select w-auto d-inline-block">
          <option *ngFor="let e of estados" [value]="e.id">{{ e.nombre }}</option>
        </select>
      </div>

      <ul class="list-group list-group-flush mb-3">
        <li class="list-group-item d-flex justify-content-between align-items-center"
            *ngFor="let d of pedido.detalles">
          <span>{{ d.nombrePlato }} x{{ d.Cantidad }}</span>
          <span>S/ {{ d.Subtotal.toFixed(2) }}</span>
        </li>
      </ul>

      <div class="d-flex justify-content-end">
        <strong>Total: S/ {{ getTotal(pedido.detalles).toFixed(2) }}</strong>
      </div>
    </div>
  </div>
</div>

<ng-template #noPedidos>
  <div class="text-center mt-5">
    <p class="fs-5 text-muted">No hay pedidos disponibles.</p>
  </div>
</ng-template>
